{"version":3,"file":"index.js","sources":["../src/helper.tsx","../src/index.tsx"],"sourcesContent":["\nconst generateQueryString = (q: any) => {\n  let queryString = '';\n  if (q) {\n    const queryKeys = Object.keys(q);\n    queryKeys.forEach(key => {\n      if (q[key]) {\n        if (q[key].toString().length) {\n          queryString += `${key}=${q[key]}&`;\n        }\n      }\n    });\n    if (queryKeys.length > 0 && queryString[queryString.length - 1] === '&') {\n      queryString = queryString.slice(0, -1);\n    }\n  }\n  return queryString;\n};\n\nexport { generateQueryString };\n","import React, { useEffect } from 'react';\n\nimport { generateQueryString } from './helper';\n\nexport interface AppleLoginProps {\n  clientId: string;\n  redirectURI: string;\n  scope?: string;\n  state?: string;\n  responseType?: string | 'code' | 'id_token';\n  responseMode?: string | 'query' | 'fragment' | 'form_post';\n  nonce?: string;\n  designProp?: {\n    // REF: https://developer.apple.com/documentation/signinwithapplejs/incorporating_sign_in_with_apple_into_other_platforms\n    height?: number;\n    width?: number;\n    color?: string | 'white' | 'black';\n    border?: boolean;\n    type?: string | 'sign-in' | 'continue';\n    border_radius?: number;\n    scale?: number;\n    locale?: string;\n  }\n  callback?: (d: any) => void;\n  render?: (props: { onClick: (e?: any) => void, disabled?: boolean }) => JSX.Element;\n}\n\nconst AppleLogin = (props: AppleLoginProps) => {\n  const { clientId, redirectURI, state = '', render, designProp = {}, responseMode = 'query', responseType = 'code', nonce, callback, scope } = props;\n\n  useEffect(() => {\n    if (typeof callback === 'function' && responseMode === 'query' && responseType === 'code' && window && window.location) {\n      let match;\n      const pl = /\\+/g,  // Regex for replacing addition symbol with a space\n        search = /([^&=]+)=?([^&]*)/g,\n        decode = (s: any) => { return decodeURIComponent(s.replace(pl, \" \")); },\n        query = window.location.search.substring(1);\n\n      let urlParams = {};\n      while (match = search.exec(query)) {\n        urlParams[decode(match[1])] = decode(match[2]);\n      }\n      if (urlParams['code']) {\n        callback({\n          code: urlParams['code']\n        });\n      }\n    }\n    return () => {\n    };\n  }, [])\n\n  const onClick = (e: any) => {\n    if (e) {\n      e.preventDefault();\n    }\n    window.location.href = `https://appleid.apple.com/auth/authorize?${generateQueryString({\n      response_type: responseType,\n      response_mode: responseMode,\n      client_id: clientId,\n      redirect_uri: encodeURIComponent(redirectURI),\n      state,\n      nonce,\n      scope: responseMode === 'query' ? '' : scope\n    })}`;\n  }\n\n  if (typeof render === 'function') {\n    return render({ onClick })\n  }\n\n  return (\n    <>\n      <div id=\"appleid-signin\" onClick={onClick}>\n        <img src={`https://appleid.cdn-apple.com/appleid/button?${generateQueryString(designProp)}`} />\n      </div>\n    </>\n  );\n};\n\nexport default AppleLogin;\n"],"names":["useEffect","React"],"mappings":"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"}